import{r as d,u as y,o as n,c,b as e,t as r,k as p,n as g,i as v,F as w,f as R,j as x,l as B}from"./index-a23329c6.js";import{_ as E}from"./lodash-fb661e38.js";const L={key:0,class:"text-center"},H={class:"text-xl font-semibold"},N={class:"flex justify-center gap-3 mt-3"},C={class:"btn btn-sm"},T=["href"],j=e("img",{class:"w-6 h-6",src:"https://img.icons8.com/fluency/48/google-sheets.png",alt:"google-sheets"},null,-1),D=e("span",{class:"material-icons"}," refresh ",-1),J=e("span",{class:"material-icons"}," publish ",-1),Q={key:0,class:"max-w-3xl mx-auto mt-4"},S={class:"overflow-x-auto"},V={class:"table"},q=e("thead",null,[e("tr",null,[e("th",null,"Rank"),e("th",null,"Name"),e("th",null,"Score")])],-1),$={__name:"ImportResponse",setup(F){const u=d(!1),a=d(null),l=d(null),_=y(),h=_.params.id;(async()=>{const s=await x.get(`/exam/${h}`);a.value=s.data})();const f=async()=>{u.value=!0;try{let s="https://script.google.com/macros/s/AKfycbxHZMx1M1oGvp-wPb7mHwQrfkDBpkS3BG0WtciUJ_HHJTswLgJ2Ba4f8XBLNHOkjYEERQ/exec?sheet="+a.value.question,o=await(await B.get(s)).data;o=E.sortBy(o.map(t=>({...t,attempt:t.attempt||1,duration:t.duration||t["duration "]})),[t=>-t.score,"duration"]).map((t,m)=>({rank:m+1,...t,course:_.params.course,exam_id:h})),l.value=o,u.value=!1}catch(s){console.log(s),u.value=!1}},i=d(!1),b=async()=>{i.value=!0;try{const s=await x.post("/result",l.value);console.log(s),i.value=!1}catch(s){console.log(s),i.value=!1}};return(s,k)=>{var o;return n(),c("div",null,[e("div",null,[a.value?(n(),c("div",L,[e("h1",H,r(a.value.name),1),e("div",N,[e("span",C," Total: "+r(a.value.totalResponses||((o=l.value)==null?void 0:o.length)),1),e("a",{class:"btn btn-sm",href:`https://docs.google.com/spreadsheets/d/${a.value.question}/edit#gid=1573239885`},[p(" Question "),j],8,T),e("button",{class:g(["btn btn-sm",{loading:u.value}]),onClick:f},[D,p(" Load Results ")],2),e("button",{class:g(["btn btn-sm",{loading:i.value}]),onClick:b},[J,p(" Export ")],2)])])):v("",!0)]),l.value?(n(),c("div",Q,[e("div",S,[e("table",V,[q,e("tbody",null,[(n(!0),c(w,null,R(l.value,(t,m)=>(n(),c("tr",{key:m},[e("th",null,r(t.rank),1),e("td",null,r(t.name),1),e("td",null,r(t.score),1)]))),128))])])])])):v("",!0)])}}};export{$ as default};
